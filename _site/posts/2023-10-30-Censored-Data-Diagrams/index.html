<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.510">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Zane Billings">
<meta name="dcterms.date" content="2023-10-30">
<meta name="description" content="Personal homepage for Zane Billings">

<title>W. Zane Billings - My data are censored!! What do I do??</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script src="../../site_libs/quarto-contrib/iconify-1.0.7/iconify-icon.min.js"></script>
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script> 
  

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">W. Zane Billings</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../presentations.html"> 
<span class="menu-text">presentations</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../uses.html"> 
<span class="menu-text">uses</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../now.html"> 
<span class="menu-text">now</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../misc.html"> 
<span class="menu-text">misc</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/wzbillings/quarto-website/" rel="me"> 
<span class="menu-text"><iconify-icon inline="" icon="bi:github" style="font-size: 1.1em;" github=""></iconify-icon></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">My data are censored!! What do I do??</h1>
                  <div>
        <div class="description">
          <p>I needed to make some censored data plots for a presentation, and it turned out to be easier to write the material as a blog post first and then convert that into a presentation afterwards.</p>
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Zane Billings </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 30, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">contents</h2>
   
  <ul class="collapse">
  <li><a href="#what-is-censored-data" id="toc-what-is-censored-data" class="nav-link active" data-scroll-target="#what-is-censored-data">What is censored data?</a></li>
  <li><a href="#censored-survival-data" id="toc-censored-survival-data" class="nav-link" data-scroll-target="#censored-survival-data">Censored survival data</a></li>
  <li><a href="#types-of-censored-data" id="toc-types-of-censored-data" class="nav-link" data-scroll-target="#types-of-censored-data">Types of censored data</a></li>
  <li><a href="#censored-non-survival-data" id="toc-censored-non-survival-data" class="nav-link" data-scroll-target="#censored-non-survival-data">Censored non-survival data</a></li>
  <li><a href="#an-aside-on-the-likelihood" id="toc-an-aside-on-the-likelihood" class="nav-link" data-scroll-target="#an-aside-on-the-likelihood">An aside on the likelihood</a></li>
  <li><a href="#mle-on-censored-data" id="toc-mle-on-censored-data" class="nav-link" data-scroll-target="#mle-on-censored-data">MLE on censored data</a></li>
  <li><a href="#the-bayesian-alternative" id="toc-the-bayesian-alternative" class="nav-link" data-scroll-target="#the-bayesian-alternative">The Bayesian alternative</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>Recently, I’ve been working a lot on censored data in the context of antibody measurements, which often have limits of detection or precision issues that can be treated as censored data problems. I’ve been working with my <a href="https://handelgroup.uga.edu/">awesome lab group</a> on a larger project about approaches for censored data analyses, but this blog post will cover the very basics. I needed to make a presentation for a seminar about this topic, and it turned out it was easier to write the blog post first and then convert it into a presentation.</p>
<p>Here are the learning goals for this blog post, and the motivating issues for me to write about. If I’ve done a decent job, by the end of this post, a diligent reader should be able to:</p>
<ol type="1">
<li>Explain what censored data is, and give an example of how censoring might occur;</li>
<li>List the types of censored data, and be able to identify these types in practical examples;</li>
<li>Write down a data generating model for censored data, and write down the likelihood for the censored variables;</li>
<li>Explain how censored data are handled in survival, tobit-type, and Bayesian models using the likelihood;</li>
<li>Identify pros and cons for frequentist and Bayesian approaches to handle censored data.</li>
</ol>
<section id="what-is-censored-data" class="level2">
<h2 class="anchored" data-anchor-id="what-is-censored-data">What is censored data?</h2>
<p><strong>Censoring</strong> is a type of data coarsening which occurs due to the way data are observed. Such data are only partially known, i.e., we know a range of values for a given data point, but not the exact value of that data point. The most common example in the literature occurs in survival analysis. Notably, when data are censored, we still have a record for a given individual, with an imprecise measurement – we will not consider <strong>truncated</strong> data here, where the measurement process completely excludes measurements which are not known precisely.</p>
</section>
<section id="censored-survival-data" class="level2">
<h2 class="anchored" data-anchor-id="censored-survival-data">Censored survival data</h2>
<p>Survival analysis methods are used to analyze data where the outcome is the time when a specific event occurs – originally death, which is where the name comes from. Survival analysis is also called reliability analysis in fields where instruments or machines are the subject of consideration rather than people. In epidemiology, these types of survival outcomes often come up in the context of a <strong>cohort study</strong>. We recruit a bunch of people, follow them for a specific amount of time, and observe when certain outcomes happen. Importantly, <em>if the study ends before we observe an outcome for a given individual, that does not mean the individual never gets an outcome.</em></p>
<p>Instead, our observation of no outcome occurrence for that individual is a feature of our observation process – we would follow all individuals in our study until they were no longer at risk for the event if we could, but real world constraints limit the amount of follow-up or observation time we can have. The outcome observation for this person is said to be <strong>right censored</strong>, which is the classical type of censoring dealt with in epidemiology. The term “right” censoring comes from the fact that this individual’s time-to-event is in the interval <span class="math inline">\((\text{end of study}, \ \infty)\)</span>, so the true value could be anywhere to the right of our observed measurement on a number line.</p>
<p>Of course, a cohort study can be defined in calendar time or in event time, but for the sake of simplicity we’ll assume that our cohort is in calendar time. Say for example, that we started our study (and had all patients recruited) on January 10, 2023 and completed all of our follow-up on May 16, 2023.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rc) <span class="sc">+</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> study_start, <span class="at">color =</span> censored, <span class="at">group =</span> id) <span class="sc">+</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> study_start, <span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">lwd =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> study_end, <span class="at">color =</span> <span class="st">"gray"</span>, <span class="at">lwd =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_segment</span>(</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">xend =</span> event_time, <span class="at">y =</span> id, <span class="at">yend =</span> id),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">lwd =</span> <span class="fl">1.5</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> study_start, <span class="at">y =</span> id),</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">3</span>, <span class="at">stroke =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">16</span>,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">show.legend =</span> <span class="cn">FALSE</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> event_time, <span class="at">y =</span> id, <span class="at">shape =</span> censored),</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">3</span>, <span class="at">stroke =</span> <span class="dv">2</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_label</span>(</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Insane date math to get the graphical midpoint</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> lubridate<span class="sc">::</span><span class="fu">as_date</span>((</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>                <span class="fu">pmax</span>(<span class="fu">as.numeric</span>(study_start), <span class="fu">as.numeric</span>(study_start <span class="sc">-</span> <span class="dv">14</span> <span class="sc">*</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">pmin</span>(<span class="fu">as.numeric</span>(event_time), <span class="fu">as.numeric</span>(study_end <span class="sc">+</span> <span class="dv">14</span> <span class="sc">*</span> <span class="dv">1</span>))</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">/</span> <span class="dv">2</span>),</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Participant #"</span>, id),</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> id <span class="sc">+</span> <span class="fl">0.25</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        ), <span class="at">fill =</span> <span class="st">"#ffffff"</span>, <span class="at">col =</span> <span class="st">"black"</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>), <span class="at">name =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_date</span>(</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">name =</span> <span class="st">"Calendar time"</span>,</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fl">0.025</span>),</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>        <span class="co">#date_breaks = "2 weeks",</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">seq</span>(study_start, study_end <span class="sc">+</span> <span class="dv">14</span>, <span class="dv">14</span>),</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">date_labels =</span> <span class="st">"%b %d"</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(study_start, study_end <span class="sc">+</span> <span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">name =</span> <span class="st">"Participant"</span>) <span class="sc">+</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">4</span>), <span class="at">name =</span> <span class="cn">NULL</span>)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"posts"</span>, pth_base, <span class="st">"rc.png"</span>),</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">16</span>, <span class="at">height =</span> <span class="dv">9</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-rc" class="quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-rc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-rc-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-rc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Example study data which include right censored observations. For this example, we assume that no one experienced the event before the study began, so only right censoring is possible. Individuals who did not experience the event before the end of the study are right-censored, and their study times are colored red. Individuals who experienced the event before the end of the study are not censored, and their study times are colored black. The points (circles for completely observed data, x’s for censored data) show the value we observe as part of the study.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Note that here we have also implicitly assumed that the only reason for a person to drop out of the study is because the event occurs. We could, in real life, have subjects who dropped out of the study before the event occurred, and in real life we would likely not have a fixed calendar date for enrollment. But we make these simplifying assumptions for now, because this kind of survival analysis is not the main point here, the idea of censoring is the main point and survival analysis is a motivating example.</p>
<p>Thinking about censored data in this way is useful for analyzing survival data, but can be misleading when trying to understand the general idea of censored data. Such a study would produce a distribution of survival times which is <strong>censored in the right tail.</strong> With only 10 observations like we show in the previous figure, visualizing the distribution of survival times might be difficult. But if we draw survival times from some parametric model, and then censor them, we can see this effect in practice. So suppose these are 10 individuals from a study that had 1000 individuals. The nature of the parametric model and how I made this distribution is not important but is explained in the callout box for anyone curious.</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Generating histogram data
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>To create the data in the previous chart showing observation and event times for each participant, I just made up dates until I got a plot that looked how I wanted it to.</li>
<li>The outcome we’re showing the distribution of here is the time-to-event, that is, the (latent) event time minus the study start time. There are several typical parametric distributions for time-to-event variables, so I randomly chose a common one called the Weibull distribution and used the function <code>MASS::fitdistr()</code> to obtain the maximum likelihood estimates for the Weibull distribution matching my made up data. <em>We can then plot the density curve on the plot below using the parameters from that distribution.</em></li>
<li>I then generated 990 independent random deviates from the Weibull distribution with those estimated parameters, then concenate those to the values I made up. We now have a larger sample that best matches the numbers I made up randomly (under a specific parametric assumption).</li>
<li>Apply censoring. That is, if a failure time is greater than the total time elapsed during the study, record it instead as the total time elapsed.</li>
</ol>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>total_time <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">interval</span>(study_start, study_end) <span class="sc">/</span> lubridate<span class="sc">::</span><span class="fu">days</span>(<span class="dv">1</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12341234</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>rc_vals <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">interval</span>(study_start, rc<span class="sc">$</span>event_time) <span class="sc">/</span> lubridate<span class="sc">::</span><span class="fu">days</span>(<span class="dv">1</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>est <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">fitdistr</span>(rc_vals, <span class="at">densfun =</span> <span class="st">"weibull"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>sim_dist_rc <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y_star =</span> <span class="fu">c</span>(</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>        rc_vals,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rweibull</span>(<span class="dv">990</span>, <span class="at">shape =</span> est<span class="sc">$</span>estimate[[<span class="dv">1</span>]], <span class="at">scale =</span> est<span class="sc">$</span>estimate[[<span class="dv">2</span>]])</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">orig =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="at">times =</span> <span class="dv">10</span>), <span class="fu">rep</span>(<span class="dv">0</span>, <span class="at">times =</span> <span class="dv">990</span>)),</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">cens =</span> <span class="fu">ifelse</span>(y_star <span class="sc">&lt;=</span> total_time, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y_cens =</span> <span class="fu">pmin</span>(total_time, y_star)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>dist_dat <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">300</span>, <span class="fl">0.01</span>),</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">dweibull</span>(x, <span class="at">shape =</span> est<span class="sc">$</span>estimate[[<span class="dv">1</span>]], <span class="at">scale =</span> est<span class="sc">$</span>estimate[[<span class="dv">2</span>]])</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sim_dist_rc) <span class="sc">+</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">#geom_vline(xintercept = total_time) +</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> y_cens, <span class="at">y =</span> <span class="fu">after_stat</span>(density)), <span class="at">binwidth =</span> <span class="dv">5</span>,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">boundary =</span> <span class="dv">0</span>,</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"gray"</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> dist_dat, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time-to-event (survival time)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/rc-dist-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"posts"</span>, pth_base, <span class="st">"rc-hist.png"</span>),</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="dv">16</span>, <span class="at">height =</span> <span class="dv">9</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here, the histogram is showing the observed data from our censored sample. There is a huge bin containing the censored values, which in this case are all survival times that were larger than the amount of time each individual spent in the study. The black curve shows the true density curve from which I sampled the data, so we can see that the censored data are censored at a specific measurement. Basically all of the density that would be above the censoring point gets pushed into the closest bin just below the censoring point. So this is how we can understand the term “right” censoring.</p>
<p>If there is right censoring, you might be wondering, is there also left censoring? The answer is yes, and it occurs in much the same way. In my first draft of this post, I got into a detailed discussion of survival analysis and censoring types here, but then realized it was not particularly helpful. So I decided to leave that bit out.</p>
<!--
If we can also recruit patients who have **already experienced the event**,
such subjects would have **left censored** survival times in our analysis. We
know that those subjects have a survival time that is less than or equal to
the amount of elapsed time since the study start and their recruitment into
the study. I think that was a really complicated way to explain that, so let's
consider an example.

Suppose we are interested in conducting a large-scale study of risk factors for
dementia in adults who are 65 or older. We will, for the purposes of this
example, exclude cases of early-onset dementia from our analysis, and thus
assume that dementia does not occur until after age 65. We continuously
recruit new patients into our study with the only inclusion criteria being
that they are at least 65 and visit a clinical site which is part of our
study. Thus, we could recruit a patient who is age 70 and has already been
diagnosed with dementia. Said participant's survival time is therefore
left-censored: we know it is less than 5, but not the actual value. (Note
here that survival times **must** be greater than zero. In a future section
we will see examples without a natural lower bound.)

Such a cohort might have a diagram that looks something like this.




::: {.cell}

```{.r .cell-code}
ggplot(lc) +
    aes(x = t2, y = id, color = censored, group = id) +
    geom_vline(xintercept = study_start, color = "gray", lwd = 2) +
    geom_vline(xintercept = study_end, color = "gray", lwd = 2) +
    geom_segment(
        aes(xend = t1, y = id, yend = id),
        lwd = 1.5,
        show.legend = FALSE
    ) +
    # geom_segment(
    #   aes(
    #       x = t1, xend = t1,
    #       y = id - 0.5, yend = id + 0.5
    #   ),
    #   lwd = 1.5,
    #   show.legend = FALSE
    # ) +
    geom_label(
        aes(
            # Insane date math to get the graphical midpoint
            x = lubridate::as_date((
                pmax(as.numeric(t1), as.numeric(study_start - 14 * 2)) +
                    pmin(as.numeric(t2), as.numeric(study_end + 14 * 1))
            ) / 2),
            label = paste0("Participant #", id)
        )
    ) +
    geom_point(
        aes(x = t2, y = id, shape = r_censored),
        size = 3, stroke = 2
    ) +
    geom_point(
        aes(x = t1, y = id, shape = l_censored),
        size = 3, stroke = 2
    ) +
    # annotate(
    #   "label",
    #   x = study_start,
    #   y = 10.75,
    #   label = "Study start"
    # ) +
    # annotate(
    #   "label",
    #   x = study_end,
    #   y = 10.75,
    #   label = "Study end"
    # ) +
    scale_color_manual(values = c("black", "red"), name = NULL) +
    scale_x_date(
        name = "Calendar time",
        expand = expansion(mult = 0.025),
        #date_breaks = "2 weeks",
        breaks = seq(study_start - 14 * 1, study_end + 14 * 1, 14),
        date_labels = "%b %d"
    ) +
    coord_cartesian(xlim = c(study_start - 14 * 1, study_end + 14 * 1)) +
    scale_y_continuous(breaks = NULL, name = "Participant") +
    scale_shape_manual(values = c(16, 4), name = NULL)
```

::: {.cell-output-display}
![The caption](index_files/figure-html/fig-lc-1.png){#fig-lc width=672}
:::
:::


Importantly, in this type of study, we **cannot define our study time-scale
in calendar time -- it doesn't make sense any more, because then our left
censored individuals would have negative time-to-event.** In the dementia
study example, we would define the survival time as the amount of time between
the participant's 65th birthday and the onset of dementia.

Leaving aside that example (so I don't have to simulate all that stuff), we can visualize what a left-censored distribution
might look like. Suppose we use the same parametric model as the previous
histogram, but this time we have as much follow-up time as we want, but we
don't observe any values 

-->
<p>Instead, let’s focus on the more general idea of censored data, and censored data types.</p>
</section>
<section id="types-of-censored-data" class="level2">
<h2 class="anchored" data-anchor-id="types-of-censored-data">Types of censored data</h2>
<p>Let’s start by writing down the <strong>data generating process</strong> for our familiar survival analysis model. This will hopefully be instructive for the types of censoring we’ll list momentarily. Recall we assume that the survival time, let’s say <span class="math inline">\(t_i\)</span>, where <span class="math inline">\(i\)</span> stands for a given individual and counts up from <span class="math inline">\(1\)</span> to <span class="math inline">\(n\)</span>, the sample size, has some parametric model. The formula for the model doesn’t matter, so we’ll call it <span class="math inline">\(f(t)\)</span> to be general. However, we don’t actually observe the value <span class="math inline">\(t_i\)</span>, we observe the censored value, say <span class="math inline">\(c_i\)</span> instead. The value <span class="math inline">\(c_i\)</span> is equal to <span class="math inline">\(t_i\)</span>, if it is less than the amount of elapased time in our study, say <span class="math inline">\(t_{\text{max}}\)</span>, otherwise it is equal to <span class="math inline">\(t_{\text{max}}\)</span>. So in math language, we would write the DGP as <span class="math display">\[
\begin{aligned}
t_i &amp;\sim f(t) \\
c_i &amp;= \min\left(t_i, t_{\max} \right).
\end{aligned}
\]</span> If we wanted to use that Weibull distribution from before as our parametric model, we would write <span class="math display">\[
\begin{aligned}
t_i &amp;\sim \mathrm{Weibull}\left(\theta\right) \\
c_i &amp;= \min\left(t_i, t_{\max} \right)
\end{aligned}
\]</span> where <span class="math inline">\(\theta\)</span> is a vector of parameters. Remember that this is called <strong>right-censored data</strong>. We can define a few other types of censoring by analogy.</p>
<ul>
<li><strong>Right censoring</strong>: the censored values are less than or equal to some maximum value.</li>
<li><strong>Left censoring</strong>: the censored values are greater than or equal to some minimum value.</li>
<li><strong>Interval censoring</strong>: the censored values are known to be in some interval, but we do not know where in that interval.</li>
</ul>
<p>Left censoring can be understood mostly by analogy to right censoring. For left censored data, we would just say <span class="math display">\[c_i = \max (t_i, t_{\min})\]</span> instead of what we wrote before. Interval censoring is somewhat more tricky however, although it occurs in a good number of circumstances.</p>
<p>To understand interval censoring, let’s talk about an example. Suppose we recruit a cohort of people who do not have HIV. If our outcome is time until diagnosis of HIV, we have to regularly test those people for HIV. Suppose we ask them to come get a test once per month because we don’t have enough funding to do it any more frequently. Once an individual tests positive, we could say their survival time was <span class="math inline">\(X\)</span> months, but this is not really true – we only know that their survival time is somewhere between this month and the previous month, so this outcome is <strong>interval censored</strong>.</p>
<p>Of course there are a lot more complications too. Here’s an incomplete list of types of censoring that you might see referenced in the wild with a short explanation.</p>
<ul>
<li><strong>Singly censored</strong>: the censoring point or threshold is a fixed, constant value, and is the same for all observations. All of the examples we’ve discussed so far are singly censored.</li>
<li><strong>Multiply censored</strong>: Censoring times vary across observations. This is common in chemical or environmental studies where concentration analysis where the threshold can change across instruments or batches.</li>
<li><strong>Doubly censored</strong>: values have both an upper and a lower threshold. Confusingly, this is not related to the idea of singly vs.&nbsp;multiply censored data. In this case, the observed censored value is given by <span class="math inline">\(c_i = \max \left\{ \min \left\{t_i, t_{\max}\right\}, t_{\min} \right\}.\)</span> Many lab measurements are doubly censored due to equipment limits. Note that this is distinct from interval censoring though they seem similar; additionally, a given observation can only be left censored or right censored, but a variable can be doubly censored.</li>
<li><strong>Type I censoring</strong>: also called “time-terminated” censoring, when the study ends at a specific point in time. Almost all epidemiologic studies fall into this category.</li>
<li><strong>Type II censoring</strong>: also called “failure-” or “event-terminated” censoring, when the study ends after a pre-specified number of failures. Such a study design can help with statistical power, but is impractical to run.</li>
<li><strong>Progressive censoring</strong>: There is a sequence of censoring times (generally called terminals) <span class="math inline">\(T_1 &lt; T_2 &lt; \ldots &lt; T_j \ldots &lt; T_k\)</span>. At the value <span class="math inline">\(T_j\)</span>, there are a total of <span class="math inline">\(c_j\)</span> censored observations of the variable <span class="math inline">\(x\)</span> where we know only that <span class="math inline">\(x &gt; T_j\)</span>. Given a sample size <span class="math inline">\(N\)</span> and a number of fully observed measurements <span class="math inline">\(n\)</span>, we have that <span class="math inline">\(N = n + \sum_{j=1}^k c_j\)</span>. This censoring scheme is rare and complicated, and we will not discuss it further.</li>
</ul>
<p>Now, given that laundry list, we can get back to the interesting discussion.</p>
</section>
<section id="censored-non-survival-data" class="level2">
<h2 class="anchored" data-anchor-id="censored-non-survival-data">Censored non-survival data</h2>
<p>So far, we have only discussed right-censored survival data. But censoring is part of the observation process, and can occur in arbitrarily complex ways on data with arbitrary generating processes. See for example the 2013 Polish <em>matura</em> exam scores in <a href="#fig-matura" class="quarto-xref">Figure&nbsp;2</a>. The data in this figure are available from a <a href="https://web.archive.org/web/20140608024521/https://www.reddit.com/r/dataisbeautiful/comments/27dx4q/distribution_of_results_of_the_matura_high_school/">2014 reddit thread</a> and from the <a href="https://web.archive.org/web/20141213135754/http://www.cke.edu.pl/images/files/matura/informacje_o_wynikach/2013/2013_Matura.pdf">original source, in Polish</a> (p.&nbsp;18).</p>
<div id="fig-matura" class="quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-matura-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="matura.png" class="img-fluid figure-img">
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-matura-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Polish matura exam scores in 2013.
</figcaption>
</figure>
</div>
<p>I guess you can tell what the passing grade for the exam was! We have a definite case of censoring here, although it is more complicated than our previous case. Here, it looks like there is some probability, based on the exam score and the grader, that a grade in the range <span class="math inline">\(\{23, \ldots, 29\}\)</span> got bumped up to a 30 (the minimum passing score) or 31. This is a censoring process with both a systematic and a random element that would probably be quite hard to model without a lot of data. Although I need to remind myself in the future that doing a little demo of a DGP to get data that looks like that might be kind of fun!</p>
<p>Extremely complicated censoring processes aside, <strong>censored non-survival data are quite common</strong>! We don’t hear about them often in epidemiology, because unfortunately as a field we are very likely to simply ignore censoring in these values and pretend it doesn’t exist. For example, I work with a lot of antibody data in my research. Antibody data, and most immunological data for that matter, tends to feature a <strong>lower limit of detection</strong> – what we called <span class="math inline">\(t_{\min}\)</span> earlier. Instead of observing the true underlying value, we observe <span class="math inline">\(\max\{t_i, t_{\min}\}\)</span>, giving us <strong>left-censored data</strong>! And of course antibody titers are not survival times, and do not follow the same distributions.</p>
<p>In fact, the most common distributional assumptions for antibody data are log-normal or gamma. Now, these can be used for parametric survival models under certain assumptions. And we are lucky that most survival models, such as the ones implemented in <code>R</code>, include those distributions in what they can fit. And we are even luckier that if <span class="math inline">\(x\)</span> is a left-censored variable, <span class="math inline">\(-x\)</span> is a right-censored variable, so we can just do a survival model with the correct distribution where the outcome is <span class="math inline">\(-x\)</span>.</p>
</section>
<section id="an-aside-on-the-likelihood" class="level2">
<h2 class="anchored" data-anchor-id="an-aside-on-the-likelihood">An aside on the likelihood</h2>
</section>
<section id="mle-on-censored-data" class="level2">
<h2 class="anchored" data-anchor-id="mle-on-censored-data">MLE on censored data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">134123</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>x_star <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(x_star <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">0</span>, x_star)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>star_dens <span class="ot">&lt;-</span> <span class="fu">density</span>(x_star, <span class="at">kernel =</span> <span class="st">"gaussian"</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>x_dens <span class="ot">&lt;-</span> <span class="fu">density</span>(x, <span class="at">kernel =</span> <span class="st">"gaussian"</span>, <span class="at">bw =</span> star_dens<span class="sc">$</span>bw)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NULL</span>, <span class="cn">NULL</span>,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fu">min</span>(star_dens<span class="sc">$</span>x, x_dens<span class="sc">$</span>x), <span class="fu">max</span>(star_dens<span class="sc">$</span>x, x_dens<span class="sc">$</span>x)),</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fu">min</span>(star_dens<span class="sc">$</span>y, x_dens<span class="sc">$</span>y), <span class="fu">max</span>(star_dens<span class="sc">$</span>y, x_dens<span class="sc">$</span>y)),</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">"x"</span>, <span class="at">ylab =</span> <span class="st">"density"</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x_star, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.1</span>), <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"#E69F0060"</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.1</span>), <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">add =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"#56B4E960"</span>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(star_dens, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x_dens, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="the-bayesian-alternative" class="level2">
<h2 class="anchored" data-anchor-id="the-bayesian-alternative">The Bayesian alternative</h2>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
</section>


<div id="quarto-appendix" class="default"><section id="details" class="level2 appendix"><h2 class="anchored quarto-appendix-heading">Details</h2><div class="quarto-appendix-contents">

<p>Last updated at 2023-11-06 09:05:47.902596.</p>
<p><a href="https://github.com/wzbillings/quarto-website/blob/main/posts/2023-10-30-Censored-Data-Diagrams">source code</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.3.1 (2023-06-16 ucrt)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19045)

Matrix products: default


locale:
[1] LC_COLLATE=English_United States.utf8 
[2] LC_CTYPE=English_United States.utf8   
[3] LC_MONETARY=English_United States.utf8
[4] LC_NUMERIC=C                          
[5] LC_TIME=English_United States.utf8    

time zone: America/New_York
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices datasets  utils     methods   base     

other attached packages:
[1] lubridate_1.9.3 ggplot2_3.4.4  

loaded via a namespace (and not attached):
 [1] gtable_0.3.1      jsonlite_1.8.7    dplyr_1.0.10      compiler_4.3.1   
 [5] renv_1.0.3        tidyselect_1.2.0  stringr_1.4.1     scales_1.2.1     
 [9] yaml_2.3.6        fastmap_1.1.0     here_1.0.1        R6_2.5.1         
[13] labeling_0.4.2    generics_0.1.3    knitr_1.40        MASS_7.3-58.2    
[17] htmlwidgets_1.5.4 tibble_3.1.8      rprojroot_2.0.3   munsell_0.5.0    
[21] pillar_1.8.1      rlang_1.1.1       utf8_1.2.2        stringi_1.7.8    
[25] xfun_0.34         timechange_0.2.0  cli_3.6.1         withr_2.5.0      
[29] magrittr_2.0.3    digest_0.6.33     grid_4.3.1        zlib_0.0.1       
[33] lifecycle_1.0.3   vctrs_0.5.0       evaluate_0.23     glue_1.6.2       
[37] farver_2.1.1      fansi_1.0.3       colorspace_2.0-3  rmarkdown_2.17   
[41] tools_4.3.1       pkgconfig_2.0.3   htmltools_0.5.3  </code></pre>
</div>
</div>


</div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div id="quarto-reuse" class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a></div></div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{billings2023,
  author = {Billings, Zane},
  title = {My Data Are Censored!! {What} Do {I} Do??},
  date = {2023-10-30},
  url = {https://wzbillings.com/posts/2023-10-30-Censored-Data-Diagrams},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-billings2023" class="csl-entry quarto-appendix-citeas" role="listitem">
Billings, Zane. 2023. <span>“My Data Are Censored!! What Do I
Do??”</span> October 30, 2023. <a href="https://wzbillings.com/posts/2023-10-30-Censored-Data-Diagrams">https://wzbillings.com/posts/2023-10-30-Censored-Data-Diagrams</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="wzbillings/quarto-website" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><i class="fa-regular fa-copyright" aria-hidden="true"></i> Zane Billings, 2023<br> All content licensed under <i class="fa-brands fa-creative-commons" aria-hidden="true"></i> <i class="fa-brands fa-creative-commons-by" aria-hidden="true"></i> <i class="fa-brands fa-creative-commons-sa" aria-hidden="true"></i> <i class="fa-brands fa-creative-commons-nc" aria-hidden="true"></i> <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">(CC BY-NC-SA 4.0)</a></p>
</div>   
    <div class="nav-footer-center">

<div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
<p>Made with <i class="fa-brands fa-r-project" aria-hidden="true"></i> and <a href="https://quarto.org/">Quarto</a><br> <a href="https://github.com/wzbillings/quarto-website">Source at <i class="fa-brands fa-github" aria-hidden="true"></i> GitHub</a></p>
</div>
  </div>
</footer>




</body></html>