{
  "hash": "5cbe8e1828b6b444039b370fea867c09",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Multilevel models for a complex open cohort\"\nauthor: \"Zane Billings\"\ndate: last-modified\ndate-format: iso\ndescription: |\n  One of the data sources that I'm using for my cohort has a complicated\n  multilevel structure. Since I had to figure out what to do with it, I\n  thought I'd write about it in case my thoughts are useful for anyone dealing\n  with similar data.\nlicense: \"CC BY-SA\"\ndraft: true\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nggplot2::theme_set(hgp::theme_ms())\n```\n:::\n\n\n\nI started this post by trying to write a StackExchange question. I thought it\nwould be fairly simple, but it kept getting longer and eventually I got stuck so\nI thought I'd go back to the drawing board. Eventually I wrote down something\nlike this.\n\n> If individuals didn't repeat, I think this would be a fairly simple structure\nbecause it amounts to a normal 3-level nested model. The model should look\nsomething like\n\nAnd at that point I realized I didn't actually know how to write out that\nmodel, so it was time to do some thinking and writing and actually figure out\nwhat I was talking about. I've used multilevel models multiple times before,\nand even took a class on longitudinal data analysis, but the complex structure\nof this problem got me. So I'll start by writing out a (simplfied, generalized)\nversion of the model problem and exactly specifying my notation. Then we\ncan talk about how to write this model in both math-language and\n`lme4`-language, and what I ultimately decided was the best model structure.\n\n## Data description\n> I am working with data from a study that has repeated measures at two scales,\nand I'm not certain how to correctly specify the structure of this model. I have\na decent amount of experience with MLN/hierarchical models, but this one has\nstumped me.\n>\n> The data were collected over multiple waves, and each wave has multiple\nindividuals. The design is a prospective open cohort, which means individuals\ncan repeat for any arbitrary pattern of waves. So, individual 1 might repeat\nfrom wave 1 all the way to wave $J$ (the final year). Individual 27 might only\nbe present in wave 3. Individual 93 might be present in waves 1, 2, 3, 7, and 9,\netc. Any arbitrary combination is allowed. So this is one level of the repeated\nmeasures structure of the data -- individuals are repeated over waves.\n>\n> Each individual also shows up twice during each season--there are multiple\ntime points in each year. So, each individual, for each year, is measured\nbetween 2 and 5 times over the course of the year. The effect of repeated\nmeasures over time, nested within each individual, needs to be treated\nseparately from the wave because there are qualitative differences between the\nwaves. (We know the dates when each wave was happening, and we have the dates\nfor each measurement, but we can't just combine things into one time variable.)\n>\n> Finally, at each time point, each individual also has multiple assays -- each\ntime point represents a serological sample, and multiple different (correlated,\ncomparable) assays are performed on the sample. So we have a cluster of\nmeasurements nested within intra-wave time points, which are nested within\nindividuals.\n\n# Simplifying models\n\nOne of the more useful things I learned in my math undergrad was\n*Pólya's principle*:\n> If you cannot solve the proposed problem, try to solve first some related problem. Could you imagine a more accessible related problem? --\n> [George Pólya](https://en.wikipedia.org/wiki/How_to_Solve_It).\n\nSo instead of immediately tackling the large and complex model all at once,\nwe should first attempt to solve some smaller, related problems. Solving\nthese smaller problems will help us to understand how all the pieces can\nfit together.\n\n## Details {.appendix}\n\nLast updated at 2024-07-13 15:41:13.920973.\n\n[source code](https://github.com/wzbillings/zlog/tree/master/_posts/posts/2024-01-15-Open-Cohort-MLM/index.Rmd)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.4.1 (2024-06-14 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 10 x64 (build 19045)\n\nMatrix products: default\n\n\nlocale:\n[1] LC_COLLATE=English_United States.utf8 \n[2] LC_CTYPE=English_United States.utf8   \n[3] LC_MONETARY=English_United States.utf8\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.utf8    \n\ntime zone: America/New_York\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices datasets  utils     methods   base     \n\nother attached packages:\n[1] ggplot2_3.5.1\n\nloaded via a namespace (and not attached):\n [1] vctrs_0.6.5       cli_3.6.3         knitr_1.48        rlang_1.1.4      \n [5] xfun_0.45         hgp_0.0.1         renv_1.0.7        jsonlite_1.8.8   \n [9] glue_1.7.0        colorspace_2.1-0  htmltools_0.5.8.1 scales_1.3.0     \n[13] fansi_1.0.6       rmarkdown_2.27    grid_4.4.1        evaluate_0.24.0  \n[17] munsell_0.5.1     tibble_3.2.1      fastmap_1.2.0     yaml_2.3.9       \n[21] lifecycle_1.0.4   compiler_4.4.1    pkgconfig_2.0.3   digest_0.6.36    \n[25] R6_2.5.1          utf8_1.2.4        pillar_1.9.0      magrittr_2.0.3   \n[29] withr_3.0.0       tools_4.4.1       gtable_0.3.5     \n```\n\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}